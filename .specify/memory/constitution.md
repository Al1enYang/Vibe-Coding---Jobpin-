# [VIBE CODING] Constitution
让每次改动可控、可复盘、可验证，避免一次性大改和偏离需求。

## Core Principles

### [需求复述与验收]
[先复述需求与验收 → 列出问题确认 → 再开始]
- 开始任何工作前：先复述需求与验收（尤其边界条件）。
- 列出需要我确认的问题；**我确认后再继续**。

### [优先相关文档和代码]
[先阅读相关代码，再做计划与任务拆分]
- 先阅读代码库中与任务相关的文件/模块（规范文档、路由、组件、API、DB schema、工具函数等）。
- 阅读后在 `specs/<feature>/plan.md` 编写计划（包含范围、假设、方案、风险、验证方式等）。

### [待办清单]
[计划必须包含可执行的待办清单]
- 在 `specs/<feature>/tasks.md` 写待办事项列表（可勾选）。
- 待办必须是可执行、可验证的粒度（避免“完成 dashboard”这种不可检验的大任务）。

### [先审核后执行]
[开始编码前必须先让我审核计划]
- 提交 `plan.md` + `tasks.md` 给我审核。
- **我审核通过后再动手写代码**。

### [小步迭代]
[小步迭代：一次只实现 1–3 条 tasks，并同步勾选进度]
- 每轮只实现 1–3 条 tasks，完成后同步在 `tasks.md` 勾选状态。
- 不允许一轮实现过多任务导致不可控改动面。

## [小幅修改]
[每一步给高层次说明 + 改动尽量小]
- 每一步都给高层次说明（做了哪些变更、为什么这样改、影响范围）。
- 任务与代码变更尽可能简化，避免庞大/复杂改动，只影响必要代码。
- 禁止“顺手重构/大改架构/与任务无关的美化”。

## [验证步骤]
[每次改动必须给出并执行验证步骤]
- 每次改动都要给出并执行验证步骤（至少包含）：
  - `lint`
  - `typecheck`
  - 关键路径手动验证（按本 feature 的验收点走一遍）
- 输出验证结果与如何复现。

### [根因修复优先]
[根因修复优先，不要临时补丁]
- 不要懒惰。永远不要懒惰。
- 如果发现 bug，必须找到根本原因并修复，不使用临时修补方案（除非我明确允许）。
- 目标是减少后续隐患与回归风险。

### [评审总结]
[在 tasks 文档追加评审总结]
- 在 `specs/<feature>/tasks.md` 最后添加 `Review/总结` 区：
  - 本轮做了什么（按文件/模块总结）
  - 风险点/遗留项
  - 与验收点对齐情况
  - 后续建议（如需）

---

## Governance（治理与变更规则）

### 1） 宪法优先级
本文件（`.specify/memory/constitution.md`）为最高优先级规则来源。若与其它文档/实现冲突：
- 先指出冲突点（引用具体段落/文件）
- 给出修正方案（修改实现 或 修改文档）
- 未经确认不得擅自更改需求含义

### 2） 修订（Amendments）规则
对本宪法的任何修改必须包含：
- 修改原因（为什么要改）
- 影响范围（会影响哪些模块/流程）
- 迁移计划（如果会导致已有实现不再符合，如何迁移）
- 生效时间点（从哪一次迭代/提交开始执行）

### 3） 合规检查（每轮迭代/每次提交）
每次开始编码前与每轮交付结束时，必须自检并显式报告：
- 是否遵守“先复述需求与验收 → 提问确认 → 再开始”
- 是否已建立 `specs/<feature>/plan.md` 与 `specs/<feature>/tasks.md` 并通过审核
- 本轮是否仅实现 1–3 条 tasks 且已勾选进度
- 是否执行并报告 lint/typecheck/关键路径验证
- 是否避免了与任务无关的大改动
- 是否未泄露任何 secret / key

### 4） 运行与实现指导入口（Guidance）
- 运行方式与环境变量：以 `README.md` 为准
- 产品规格与验收：以 `spec.md` 为准
- Claude Code 入口索引：以 `CLAUDE.md` 为准（不重复宪法）

**Version**: 1.1.0 | **Ratified**: 2026-01-08 | **Last Amended**: 2026-01-08

